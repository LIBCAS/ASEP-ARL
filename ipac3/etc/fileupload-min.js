Ext.ns("Ext.ux.form"),Ext.ux.form.FileUploadField=Ext.extend(Ext.form.TextField,{buttonText:"Browse..",buttonOnly:!1,buttonOffset:3,readOnly:!0,autoSize:Ext.emptyFn,initComponent:function(){Ext.ux.form.FileUploadField.superclass.initComponent.call(this),this.addEvents("fileselected")},onRender:function(t,e){Ext.ux.form.FileUploadField.superclass.onRender.call(this,t,e),this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-file-wrap"}),this.el.addClass("x-form-file-text"),this.el.dom.removeAttribute("name"),this.createFileInput();var i=Ext.applyIf(this.buttonCfg||{},{text:this.buttonText});this.button=new Ext.Button(Ext.apply(i,{renderTo:this.wrap,hidden:this.hideButton,cls:"x-form-file-btn"+(i.iconCls?" x-btn-icon":"")})),this.buttonOnly&&(this.el.hide(),this.hideButton||this.wrap.setWidth(this.button.getEl().getWidth())),this.bindListeners(),this.resizeEl=this.positionEl=this.wrap},bindListeners:function(){this.fileInput.on({scope:this,mouseenter:function(){this.button&&this.button.addClass(["x-btn-over","x-btn-focus"])},mouseleave:function(){this.button&&this.button.removeClass(["x-btn-over","x-btn-focus","x-btn-click"])},mousedown:function(){this.button&&this.button.addClass("x-btn-click")},mouseup:function(){this.button&&this.button.removeClass(["x-btn-over","x-btn-focus","x-btn-click"])},change:function(){var t=this.fileInput.dom.value;t=t.replace(/^.*\\/,""),this.setValue(t),this.fireEvent("fileselected",this,t)}})},createFileInput:function(){this.fileInput=this.wrap.createChild({id:this.getFileInputId(),name:"file[]",cls:"x-form-file",tag:"input",type:"file",size:1})},reset:function(){this.fileInput.remove(),this.createFileInput(),this.bindListeners(),Ext.ux.form.FileUploadField.superclass.reset.call(this)},getFileInputId:function(){return this.id+"-file"},onResize:function(t,e){if(Ext.ux.form.FileUploadField.superclass.onResize.call(this,t,e),this.wrap.setWidth(t),!this.buttonOnly){var i=0;this.button&&(i=this.button.getEl().getWidth()),t=this.wrap.getWidth()-i-this.buttonOffset,this.el.setWidth(t)}},onDestroy:function(){Ext.ux.form.FileUploadField.superclass.onDestroy.call(this),Ext.destroy(this.fileInput,this.button,this.wrap)},onDisable:function(){Ext.ux.form.FileUploadField.superclass.onDisable.call(this),this.doDisable(!0)},onEnable:function(){Ext.ux.form.FileUploadField.superclass.onEnable.call(this),this.doDisable(!1)},doDisable:function(t){this.fileInput.dom.disabled=t,this.button&&this.button.setDisabled(t)},preFocus:Ext.emptyFn,alignErrorIcon:function(){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}}),Ext.reg("fileuploadfield",Ext.ux.form.FileUploadField),Ext.form.FileUploadField=Ext.ux.form.FileUploadField;